# Xcodeファイル更新ガイド（何駅前アラート追加版）

## 更新が必要なファイル

### 1. Core Data関連
- **CoreDataManager.swift**
  - Alert entityに`notificationStationsBefore`と`notificationType`フィールドを追加
  
- **Alert+CoreDataClass.swift**
  - 新しいプロパティの@NSManaged宣言を追加

### 2. View関連
- **TimetableAlertSetupView.swift**
  - 通知タイプ選択UI（時間/駅数）を追加
  - 何駅前選択UI（1〜5駅前）を追加
  - プレビューメッセージの更新
  
- **HomeView.swift**
  - アラート表示で駅数ベースの表記に対応

## 動作確認手順

### 1. 経路検索からのアラート作成
1. ホーム画面で「時刻表から設定」をタップ
2. 経路を検索（例：東京→新宿）
3. 時刻表から電車を選択
4. アラート設定画面で以下を確認：
   - 「時間で設定」「駅数で設定」の切り替えボタンが表示される
   - 「駅数で設定」を選択すると、1〜5駅前の選択肢が表示される
   - プレビューが「あと2駅で到着予定です」のように表示される

### 2. ホーム画面での表示確認
- 作成したアラートが「2駅前」のように表示される
- 既存の時間ベース（5分前）や距離ベース（500m）と混在できる

### 3. 通知タイプの使い分け
- **時間で設定**：従来通り、到着時刻の何分前に通知
- **駅数で設定**：到着駅の何駅前に通知（遅延に強い）

## ビルド状態
- エラー：なし ✅
- 新規警告：なし ✅

## 注意事項
- 現時点では駅数のカウントは手動設定のみ
- 実際の位置追跡による駅数カウントは今後実装予定